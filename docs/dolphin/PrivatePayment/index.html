<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">🤿 Private Payment | Manta Network Technical Resources</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.manta.network/docs/dolphin/PrivatePayment"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="🤿 Private Payment | Manta Network Technical Resources"><meta data-react-helmet="true" name="description" content="Manta is all about bringing privacy to the wider blockchain space, and an important part of making privacy practical to use is the construction of simple and powerful privacy primitives. The first and most powerful primitive we are building is Private Payment, more specifcally, a multi-asset decentralized anonymous payment protocol."><meta data-react-helmet="true" property="og:description" content="Manta is all about bringing privacy to the wider blockchain space, and an important part of making privacy practical to use is the construction of simple and powerful privacy primitives. The first and most powerful primitive we are building is Private Payment, more specifcally, a multi-asset decentralized anonymous payment protocol."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.manta.network/docs/dolphin/PrivatePayment"><link data-react-helmet="true" rel="alternate" href="https://docs.manta.network/docs/dolphin/PrivatePayment" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.manta.network/docs/dolphin/PrivatePayment" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.41d6c32d.css">
<link rel="preload" href="/assets/js/runtime~main.54a416bb.js" as="script">
<link rel="preload" href="/assets/js/main.2caad291.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/manta-256x256.png" alt="Manta Network Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/manta-256x256.png" alt="Manta Network Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Manta Network Docs</b></a><a href="https://manta.network" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Manta Network<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/Manta-Network" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">🌜</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">🌞</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/manta/Overview">Manta</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/calamari/Overview">Calamari (Manta&#x27;s Canary Network)</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/calamari/Overview">📝 Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/calamari/KMA">🐙 Calamari Token (KMA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/calamari/Governance">🎙  Governance Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/calamari/api">🛠  Calamari API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/calamari/CrowdloanClaim">🎟  Crowdloan Token Claim</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/docs/dolphin/Overview">Dolphin</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dolphin/Overview">📝 Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dolphin/DolphinPay">🐬 DolphinPay</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/dolphin/PrivatePayment">🤿 Private Payment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dolphin/PrivateExchange">💱 Private Exchange</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/signer/Overview">Signer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/collator/CommunityCollatorProgram">Collators</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/collator/CommunityCollatorProgram">🧩  Community Collator Program</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/collator/HowToApply">👩🏼‍💻 How to apply to run a Calamari collator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/collator/SetupAndRun">🚄 Setup and run a Calamari collator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/collator/HowToLeave">💔 Leaving the collator program</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>🤿 Private Payment</h1><p>Manta is all about bringing privacy to the wider blockchain space, and an important part of making privacy practical to use is the construction of simple and powerful privacy primitives. The first and most powerful primitive we are building is <em>Private Payment</em>, more specifcally, a <em>multi-asset decentralized anonymous payment protocol</em>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="how-does-it-work">How Does It Work?<a class="hash-link" href="#how-does-it-work" title="Direct link to heading">​</a></h2><p>We recently posted a tech talk that explains the protocol in some detail:</p><p><a href="https://www.youtube.com/watch?v=qmRChiIDl2A" target="_blank" rel="noopener noreferrer"><img alt="Tech Talk #1" src="data:image/jpeg;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6YjJmYmJhNDkwZWExMDMzMjFkODU1ZTBjYmFjZWVkOTUyYzE3ZGVmYzg5ZjA3NDMxM2IyNGNjYWQ4ZjQ3MDdlMApzaXplIDI2ODMzCg=="></a></p><p>You can follow along with <a href="https://www.youtube.com/watch?v=qmRChiIDl2A" target="_blank" rel="noopener noreferrer">this video</a>, <a target="_blank" href="/assets/files/tech-talk-1-slides-d65be1e316c7f0f5c49c04700487c715.pdf">download the slides</a>, and/or keep reading below to get an overview and some technical details about how <em>Private Payment</em> works.</p><p>Currently, the formal specification for <em>Private Payment</em> is still closed source, but stay tuned for its public release in the near future!</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="public-ledgers">Public Ledgers<a class="hash-link" href="#public-ledgers" title="Direct link to heading">​</a></h2><p>Most decentralized systems of digital money use what are called <em>public ledgers</em> to keep track of the flow of money. Public ledgers store the current state of every participant&#x27;s balances, and whenever someone tries to spend from their account, the blockchain will come to consensus on whether this transaction is valid and updates the state. However, to validate a transaction the public ledger needs to know which sender and receiver are participating, and what amount is being transfered. We would like to find a way to avoid this and preserve the privacy of all parties involved in transactions and keep amounts private as well.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="properties-of-a-decentralized-anonymous-payment-protocol">Properties of a Decentralized Anonymous Payment Protocol<a class="hash-link" href="#properties-of-a-decentralized-anonymous-payment-protocol" title="Direct link to heading">​</a></h2><p>When designing a <em>private ledger</em>, we want the following two properties to hold:</p><ol><li>A transaction cannot modify the total supply of an asset. Only the ownership, the <em>exclusive</em> right to spend the asset in the future, can change.</li><li>Reading the ledger cannot reveal any information about a transaction or existing user balances</li></ol><p>These two properties seem to be at odds with each other since we want to verify that the total supply remains fixed but we must do so without learning what the underlying transaction is!</p><p>Fortunately, some new cryptographic protocols can save the day, namely zkSNARKs, <em>zero-knowledge Succinct Non-interactive ARguments of Knowledge</em>. We will see later which role they play in privatizing the payment protocol.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">​</a></h2><p>We will first describe a simplified version of the protocol, following two imaginary participants <code>Alice</code> and <code>Bob</code>, and we want to find a way to have <code>Alice</code> send an asset to <code>Bob</code> using a private <code>Ledger</code>. We will describe the protocol in the following steps:</p><ol><li><a href="#send-and-receive">Send and Receive</a></li><li><a href="#shared-secrets">Shared Secrets</a></li><li><a href="#encrypt-and-decrypt">Encrypt and Decrypt</a></li><li><a href="#ownership-certificates">Ownership Certificates</a></li><li><a href="#zero-knowledge-transfer-proof">Zero-Knowledge Transfer Proof</a></li></ol><p>This discussion is not entirely self-contained but we will attempt to explain cryptographic protocols only as black boxes by their interfaces and security guarantees. Further reading on each of the subjects below is encouraged.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="participants-in-detail">Participants (in detail)<a class="hash-link" href="#participants-in-detail" title="Direct link to heading">​</a></h3><ul><li><code>Alice</code> (<em>sender</em>): a participant that already has access to some assets and is guaranteed by the <code>Ledger</code> the ability to spen them.</li><li><code>Bob</code> (<em>receiver</em>): a participant that can be uniquely identified by other <em>senders</em> and will be guaranteed the ability to spend received assets in the future.</li><li><code>Ledger</code>: represents all public information (the <em>state</em>) and the network of validators (<em>blockchain</em>) which come to consensus on the private transfer of ownership of assets between <em>senders</em> and <em>receivers</em>.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="send-and-receive">Send and Receive<a class="hash-link" href="#send-and-receive" title="Direct link to heading">​</a></h2><p>For <code>Alice</code> to send her assets to <code>Bob</code>, she communicates with the <code>Ledger</code> as an intermediary. The <code>Ledger</code> operates <em>asynchronously</em> and is distributed across the internet, and so, many computers can access the <code>Ledger</code> and send and receive messages to and from the network. <code>Alice</code> will send a transfer message to the <code>Ledger</code> and if accepted, it will be used to update the state of the <code>Ledger</code>, and the changes are propagated to all of the network. <code>Bob</code> will query the network, asking for new updates to the state. If there is a new <code>Ledger</code> state, he will download it and analyze it to see if he has received any new assets. Here are those two protocols in detail: </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="send">Send<a class="hash-link" href="#send" title="Direct link to heading">​</a></h3><p><code>Alice</code> begins by constructing a special number called <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">E</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, the <em>ephemeral secret key</em>, which she will use to represent this unique transfer. She constructs it by taking <code>Bob</code>&#x27;s <em>pubic key</em>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">PK</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{PK}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">PK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, some public data from the <code>Ledger</code>, and some randomness:</p><p><img alt="Send Protocol" src="data:image/png;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6MzMxNTZmOTY0ODVkYjUxMGZkNDcyNWNkOTJiYzU3YWVhNjBiYmJhZmFkNWM0ZDc0MGNhYjMwZTg5ZWFmNWM3NQpzaXplIDEyNjgwMAo="></p><p>This is built using a <em>commitment scheme</em> which commits to <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Λ</mi></mrow><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord">Λ</span></span></span></span></span> (the ledger checkpoint), and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">PK</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{PK}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">PK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> using <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span></span> as the randomness (A.K.A blinder, or trapdoor):</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">E</mtext></msub><mo>:</mo><mo>=</mo><mtext mathvariant="sans-serif">COM</mtext><mo stretchy="false">(</mo><mi mathvariant="normal">Λ</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mtext mathvariant="sans-serif">PK</mtext><mtext mathvariant="sans-serif">B</mtext></msub><mo separator="true">,</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{E} := \textsf{COM}(\Lambda || \textsf{PK}_\textsf{B}, \tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord textsf">COM</span></span><span class="mopen">(</span><span class="mord">Λ</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord text"><span class="mord textsf">PK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span></span></div><p>This ephemeral key is only used once. <code>Alice</code> will have to prove later that she constructed <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">E</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> properly, called <em>opening</em> the commitment. The commitment is <em>binding</em> which means that <code>Alice</code> will not be able to change her mind and find another public key or ledger checkpoint to construct the same ephemeral key. The trapdoor <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span></span> gives us the <em>hiding</em> property which means that even if someone knows <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Λ</mi></mrow><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord">Λ</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">PK</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{PK}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">PK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> they won&#x27;t be able to predict what <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">E</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> is without knowing <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span></span>.</p><p><code>Alice</code> now uses the ephemeral key, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">E</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, her own secret key <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, and the asset that she received from the <code>Ledger</code> earlier, to build a <em>private asset</em>. We will see as we go along how exactly the private asset is built.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="receive">Receive<a class="hash-link" href="#receive" title="Direct link to heading">​</a></h3><p>Once <code>Alice</code> finishes her communication with the <code>Ledger</code> and the <code>Ledger</code> accepts her private asset, it will store that private asset forever, waiting for someone to claim it. <code>Bob</code> wishes to claim it, so he goes to the <code>Ledger</code> and asks for all of the newest private assets since his last query. The <code>Ledger</code> will send them to <code>Bob</code> and he will use his secret key <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> to scan through the private assets to find the ones he now owns. </p><p><img alt="Receive Protocol" src="data:image/png;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6ZDFlOTQyN2Y2Mzc3ZTcyMWExZjYwNzE2ZmJkZWE5MWI0MzI5NjJhYjllMGU1NDU3ODUxZDk1ZGQwNWZkYmYwZApzaXplIDE2ODUwNgo="></p><p>The secret key that <code>Bob</code> is using for this scanning process must be the one that <em>derived</em> the public key <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">PK</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{PK}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">PK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> which <code>Alice</code> used to build the private asset. This <em>key derivation</em> must be irreversible so that no one can discover (in a reasonable amount of time) what <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> is just from the knowledge of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">PK</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{PK}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">PK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</p><p><strong>NOTE</strong>: Because the <code>Ledger</code> will be around for a long time, <code>Bob</code> can wait as long as he likes to receive the new private assets.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="shared-secrets">Shared Secrets<a class="hash-link" href="#shared-secrets" title="Direct link to heading">​</a></h2><p>But how will <code>Bob</code> be able to claim is new assets? How will he be able to spend them in the future?</p><p>One of the most important cryptographic tools that we can take advantage of here is the <em>shared secret</em>. Essentially, we want to find a way to take some information and wrap it up so that only two people have access to it. Getting someone to share a secret with themselves is easy, they just don&#x27;t tell anyone. But how do we tell someone else our secrets so that only the two of you ever know what it is?</p><p>One of the most common ways to do this is with the <em>Diffie-Hellman Key Exchange</em> protocol. In this protocol, we take an operation that we assume is impossible to reverse (in a reasonable amount of time), let&#x27;s call it <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="sans-serif">bind</mtext></mrow><annotation encoding="application/x-tex">\textsf{bind}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord text"><span class="mord textsf">bind</span></span></span></span></span></span>, and a public constant <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal">G</span></span></span></span></span> that everyone agrees on. We choose <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="sans-serif">bind</mtext></mrow><annotation encoding="application/x-tex">\textsf{bind}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord text"><span class="mord textsf">bind</span></span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal">G</span></span></span></span></span> so that it has the following property:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext mathvariant="sans-serif">bind</mtext><mo stretchy="false">(</mo><mi>y</mi><mo separator="true">,</mo><mtext mathvariant="sans-serif">bind</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>G</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mtext mathvariant="sans-serif">bind</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mtext mathvariant="sans-serif">bind</mtext><mo stretchy="false">(</mo><mi>y</mi><mo separator="true">,</mo><mi>G</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\textsf{bind}(y, \textsf{bind}(x, G)) = \textsf{bind}(x, \textsf{bind}(y, G))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord textsf">bind</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord text"><span class="mord textsf">bind</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal">G</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord textsf">bind</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord text"><span class="mord textsf">bind</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal">G</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></div><p>Let&#x27;s call <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal">x</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span></span> secret keys and call <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>:</mo><mo>=</mo><mtext mathvariant="sans-serif">bind</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X := \textsf{bind}(x, G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord textsf">bind</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>:</mo><mo>=</mo><mtext mathvariant="sans-serif">bind</mtext><mo stretchy="false">(</mo><mi>y</mi><mo separator="true">,</mo><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Y := \textsf{bind}(y, G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord textsf">bind</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span></span> public keys. Since <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="sans-serif">bind</mtext></mrow><annotation encoding="application/x-tex">\textsf{bind}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord text"><span class="mord textsf">bind</span></span></span></span></span></span> is irreversible, we can leave <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span></span></span></span></span> out in the open for anyone to see, or even if we want to be discrete we can still send <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span></span> or <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span></span></span></span></span> to only a particular person, but we don&#x27;t have to worry that someone can reverse engineer our keys if they get their hands on it.</p><p>Because the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="sans-serif">bind</mtext></mrow><annotation encoding="application/x-tex">\textsf{bind}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord text"><span class="mord textsf">bind</span></span></span></span></span></span> function has the property above, we actually have our shared secret:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mo>:</mo><mo>=</mo><mtext mathvariant="sans-serif">bind</mtext><mo stretchy="false">(</mo><mi>y</mi><mo separator="true">,</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mtext mathvariant="sans-serif">bind</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S := \textsf{bind}(y, X) = \textsf{bind}(x, Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord textsf">bind</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord textsf">bind</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span><span class="mclose">)</span></span></span></span></span></div><p>So if you share your public key <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span></span> with someone and get their public key <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span></span></span></span></span>, then you both can compute the shared secret, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span></span></span></span></span>. In the rest of the protocol, <code>Alice</code> and <code>Bob</code> will share several secrets on their way to performing a successful transfer.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="encrypt-and-decrypt">Encrypt and Decrypt<a class="hash-link" href="#encrypt-and-decrypt" title="Direct link to heading">​</a></h2><p>The first place that <code>Alice</code> and <code>Bob</code> use <em>shared secrets</em> is to share <em>encryption</em> keys. These keys are used to send the asset value that we want to transfer in a secret message from <code>Alice</code> to <code>Bob</code>. This is called the <em>in-band secret distribution</em>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="encryption">Encryption<a class="hash-link" href="#encryption" title="Direct link to heading">​</a></h3><p>For <code>Alice</code> to send the asset value to <code>Bob</code>, she uses a <em>hybrid public-key encryption scheme</em> to <em>encrypt</em> the asset. She does this by taking <code>Bob</code>&#x27;s public key <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">PK</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{PK}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">PK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> and the <em>ephemeral secret key</em> for this particular transaction <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">E</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> and performing a Diffie-Hellman Key Exchange (in this case using elliptic curves to define the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="sans-serif">bind</mtext></mrow><annotation encoding="application/x-tex">\textsf{bind}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord text"><span class="mord textsf">bind</span></span></span></span></span></span> function), to compute a shared encryption key <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></span>. </p><p><img alt="Encryption (Full)" src="data:image/png;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6ZWU3MTJiZTYzZjFmYThlMmM0Mzg2OWI4NjlmMDNmNDg1YjE2ZTg4ZDJmZGU2OWYxOWYyMjJiNTlkMjBjOTZiNwpzaXplIDE1OTg1NAo="></p><p><code>Alice</code> then uses the <em>Blake2s</em> key derivation function to produce another key <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>K</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">K^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span> which will be the right size for the standard <em>AES-GCM</em> encryption scheme with message authentication. <code>Alice</code> encrypts the asset with <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>K</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">K^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span> and appends the derived public ephemeral key <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">PK</mtext><mtext mathvariant="sans-serif">E</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{PK}_\textsf{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">PK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> to the ciphertext message. This forms part of the private asset that <code>Alice</code> sends to the <code>Ledger</code>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="decryption">Decryption<a class="hash-link" href="#decryption" title="Direct link to heading">​</a></h3><p><code>Bob</code> will then download the new private assets from the <code>Ledger</code>, and to see if any of the new assets are his to spend, he will try to decrypt them by building the same shared secrets <code>Alice</code> used for encryption.</p><p><img alt="Decryption (Full)" src="data:image/png;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6OWNiNTY2YjJjYjE2ZDE3ZGRjMmNjMTIyNmViYzEzODI4MDIxYThmYmZkNDIwNGNmMDJhZWIzODJlNTdkZGRmMApzaXplIDExNjY4NQo="></p><p>In this case, <code>Bob</code> uses his secret key, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, and the public ephemeral key attached to the private asset, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">PK</mtext><mtext mathvariant="sans-serif">E</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{PK}_\textsf{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">PK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, to build the Diffie-Hellman shared secret, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></span>, then using the same <em>Blake2s</em> function to derive <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>K</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">K^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span>, and then performing <em>AES-GCM</em> decryption. The decryption will check that the message authentication can be reconstructed properly and if the key <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>K</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">K^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span> was different than the one used to build the message, it will fail, and <code>Bob</code> will know the asset is not his. If the encryption succeeded, then <code>Bob</code> will store the private asset on his local computer to spend later.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="ownership-certificates">Ownership Certificates<a class="hash-link" href="#ownership-certificates" title="Direct link to heading">​</a></h2><p>Now we know how <code>Alice</code> can communicate to <code>Bob</code> the amount of value she has sent to him. But still, the <code>Ledger</code> must only accept asset transfers which can provably transfer the <em>future spending power</em> from the sender to the receiver, all the while, preserving the privacy of all parties involved. Just because <code>Alice</code> sends <code>Bob</code> an encrypted asset does not mean she cannot send it again, or send it to someone else. We need a way to keep track of who owns what and be able to take away that power once someone spends an asset.</p><p>To satisfy this constraint, <code>Alice</code> will generate two kinds of certificates, <em>UTXOs</em> and <em>void numbers</em>.</p><p>A <em>UTXO</em> or <em>Unspent Transation Output</em>, is a certificate for the future spending of one of the receivers of a transaction. It is used in some public ledger protocols in the following way:</p><ol><li>Prove that <code>Alice</code> owns one of the current UTXOs</li><li>Drop <code>Alice</code>&#x27;s UTXO from the <code>Ledger</code></li><li>Create a new UTXO for <code>Bob</code></li></ol><p>In this way, the current set of UTXOs represents all of the users which have some amount of assets and how much they all own. For <code>Alice</code> to spend her asset, she needs to present a certificate <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">CM</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{CM}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> which represents that <code>Alice</code> was a receiver in a past transaction. She will need to prove that the <code>Ledger</code> has seen this UTXO before.</p><p><img alt="Ownership Certificates" src="data:image/png;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6ZDQxMTRlNjBlNzU5YWI0ZjQ2OWYxMmZlNGEwM2E2ZjQ0N2U4MmUzZDI5OTg0NmZiMzRlNzE4MmQ1Mzk0NTllZApzaXplIDIwNDYwOQo="></p><p>To transfer the asset to <code>Bob</code>, <code>Alice</code> generates a new UTXO, called <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">CM</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{CM}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, on <code>Bob</code>&#x27;s behalf. <code>Alice</code> will also need to revoke her old UTXO somehow. She does this by generating a <em>void number</em>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">VN</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{VN}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">VN</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, which is tied to her <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">CM</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{CM}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> in such a way that:</p><ol><li>The same <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">CM</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{CM}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> will always generate the same <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">VN</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{VN}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">VN</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</li><li>Different <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="sans-serif">CM</mtext></mrow><annotation encoding="application/x-tex">\textsf{CM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord text"><span class="mord textsf">CM</span></span></span></span></span></span> generate different <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="sans-serif">VN</mtext></mrow><annotation encoding="application/x-tex">\textsf{VN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord text"><span class="mord textsf">VN</span></span></span></span></span></span>.</li><li>No one can tell which <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">CM</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{CM}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">VN</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{VN}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">VN</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> belongs to.</li><li>Only <code>Alice</code> can construct <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">VN</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{VN}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">VN</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</li></ol><p>Let&#x27;s see how <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="sans-serif">CM</mtext></mrow><annotation encoding="application/x-tex">\textsf{CM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord text"><span class="mord textsf">CM</span></span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="sans-serif">VN</mtext></mrow><annotation encoding="application/x-tex">\textsf{VN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord text"><span class="mord textsf">VN</span></span></span></span></span></span> are constructed.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="receiver-certificates">Receiver Certificates<a class="hash-link" href="#receiver-certificates" title="Direct link to heading">​</a></h3><p>In order for <code>Alice</code> to create <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">CM</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{CM}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> on <code>Bob</code>&#x27;s behalf, she computes another shared secret, called <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">T</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{T}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">T</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, the trapdoor, to the UTXO commitment <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">CM</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{CM}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</p><p><img alt="Receiver UTXO" src="data:image/png;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6MWYzZWY0YmI0YmJhY2I1NzMzODRhYjNkMjAyYzhlODFkYjE4NDQwYjllNzg4YjBhZjVjNDY2ZTYxNGUxNzU5NQpzaXplIDEyNTI4OAo="></p><p>The commitment consists of the asset amount that <code>Alice</code> wants to transfer and the shared trapdoor. The trapdoor is the random part of the commitment that ensures the <em>hiding</em> property. The <em>binding</em> property of the commitment ensures that <code>Alice</code> can&#x27;t put some fake information into the commitment and then <code>Bob</code> ends up with some assets he can&#x27;t spend.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="sender-certificates">Sender Certificates<a class="hash-link" href="#sender-certificates" title="Direct link to heading">​</a></h3><p>For <code>Alice</code> to generate her void number certificate, she takes the trapdoor, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">T</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{T}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">T</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> that was used to build her <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">CM</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{CM}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, and commits to her secret key <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</p><p><img alt="Sender UTXO and Void Number" src="data:image/png;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6YzFiYjMwNDIzOGFkZDRiYTk5OTY5MWIxNjM1YWM2YzI0OGMxYjU2Njg0ZTQ4MTEwMzMyOGVhYmQxNDMzODZkNgpzaXplIDE3MzU1OQo="></p><p>The void number <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">VN</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{VN}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">VN</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> is tied to the commitment because it uses the same trapdoor, and only <code>Alice</code> can perform this computation because <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> is only known to her.</p><p>In order to prove that her UTXO is already on the <code>Ledger</code>, <code>Alice</code> can create a <em>Merkle-Proof</em>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\pi_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, attesting to this fact.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="zero-knowledge-transfer-proof">Zero-Knowledge Transfer Proof<a class="hash-link" href="#zero-knowledge-transfer-proof" title="Direct link to heading">​</a></h2><p>But <code>Alice</code> has done all of these computations in secret, involving a lot of secret information which would compromise her account if she shared with anyone. How can the <code>Ledger</code> trust that she did this computation fairly?</p><p><code>Alice</code> can take advantage of zkSNARKs, <em>zero-knowledge Succinct Non-interactive Arguments of Knowledge</em> to do the computation entirely on her own machine. zkSNARKs work like this:</p><ol><li><code>Alice</code> and the <code>Ledger</code> agree in public on some algorithm to check (ex: some computer program to execute or the protocol above). They agree on which variables in the algorithm are secret and which are public.</li><li><code>Alice</code> performs the computation of that algorithm on her own machine with her own chosen secret input and public input. </li><li>Using the output of the computation, <code>Alice</code> builds a proof <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span></span></span></span></span> that the computation was done correctly (because of succinctness, this is a very small file compared to the size of the algorithm)</li><li><code>Alice</code> sends <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span></span></span></span></span> to the <code>Ledger</code> and it can check quickly if the computation that produced this file was in-fact the agreed-upon algorithm in which case he accepts or rejects.</li></ol><p><img alt="ZKP Details" src="data:image/png;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6NDNmMTg4NmY5YmY0YzZjOWNkZWU4NDQ1M2IwNjJmMTZiNmNhYmIzODgwNzM4NjkxMjAyZjJjZWUzZGJlZTI4NwpzaXplIDEwNTI0Ngo="></p><p><code>Alice</code> can use zkSNARKs to compute all the different objects in the <em>Private Payment Protocol</em> above. When she does this, she gains the following privacy guarantees:</p><ol><li><strong>Private Sender</strong>: Because <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">CM</mtext><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{CM}_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mtext mathvariant="sans-serif">A</mtext></msub></mrow><annotation encoding="application/x-tex">\pi_\textsf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> are secret, the <code>Ledger</code> won&#x27;t know which UTXO belongs to <code>Alice</code>, just that it is in fact one of the ones stored on the <code>Ledger</code>.</li><li><strong>Private Receiver</strong>: Because the construction of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">E</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> is secret, no one knows that it comes from <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">PK</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{PK}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">PK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</li><li><strong>Private Asset</strong>: Because <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">SK</mtext><mtext mathvariant="sans-serif">E</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{SK}_\textsf{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">SK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="sans-serif">PK</mtext><mtext mathvariant="sans-serif">B</mtext></msub></mrow><annotation encoding="application/x-tex">\textsf{PK}_\textsf{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord textsf">PK</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord textsf mtight">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, and the asset amount are secret, no one can decrypt the encrypted asset except <code>Bob</code>.</li></ol><p>So we have successfully built a Private Payment Protocol!</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="generalized-n-to-m-transfer-protocol">Generalized N-to-M Transfer Protocol<a class="hash-link" href="#generalized-n-to-m-transfer-protocol" title="Direct link to heading">​</a></h2><p>In general, we need more than just a 1-to-1 transfer to be able to have usable money. For example, if <code>Alice</code> sends <code>Bob</code> five units and he wants to send <code>Carol</code> three units, he cannot use a 1-to-1 because he can&#x27;t subdivide his assets. To do this, we generalize the above protocol to an <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span></span>-to-<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span></span></span></span> protocol.</p><p><img alt="Generalized Protocol" src="data:image/png;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6ODYxOGUyYWI3Y2U0M2M1ZjQ4ZjA1ZmY0NjA3ZDc3Y2YwNmNhZjIxZjVlZTllYjY3NTQ2Mzc0ZjEwYjhjOTQ5NgpzaXplIDExNzczMQo="></p><p>We can repeat the construction for each individual <em>sender</em> and <em>receiver</em> and so <code>Bob</code> can send his asset to <code>Carol</code> by sending three units to her and sending two back to himself. Because the entire protocol is private, no one except <code>Bob</code> knows that he has done this.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="theres-more">There&#x27;s More<a class="hash-link" href="#theres-more" title="Direct link to heading">​</a></h2><p>There are some more details that you have to get right to build a real Private Payment scheme, like private wallets, fee proxies, and more. Right now these ideas are still brewing, but there&#x27;s some cool stuff coming soon, so stay tuned!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Manta-Network/docs/edit/main/docs/dolphin/PrivatePayment.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/dolphin/DolphinPay"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">🐬 DolphinPay</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/dolphin/PrivateExchange"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">💱 Private Exchange</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-does-it-work" class="table-of-contents__link toc-highlight">How Does It Work?</a></li><li><a href="#public-ledgers" class="table-of-contents__link toc-highlight">Public Ledgers</a></li><li><a href="#properties-of-a-decentralized-anonymous-payment-protocol" class="table-of-contents__link toc-highlight">Properties of a Decentralized Anonymous Payment Protocol</a></li><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#participants-in-detail" class="table-of-contents__link toc-highlight">Participants (in detail)</a></li></ul></li><li><a href="#send-and-receive" class="table-of-contents__link toc-highlight">Send and Receive</a><ul><li><a href="#send" class="table-of-contents__link toc-highlight">Send</a></li><li><a href="#receive" class="table-of-contents__link toc-highlight">Receive</a></li></ul></li><li><a href="#shared-secrets" class="table-of-contents__link toc-highlight">Shared Secrets</a></li><li><a href="#encrypt-and-decrypt" class="table-of-contents__link toc-highlight">Encrypt and Decrypt</a><ul><li><a href="#encryption" class="table-of-contents__link toc-highlight">Encryption</a></li><li><a href="#decryption" class="table-of-contents__link toc-highlight">Decryption</a></li></ul></li><li><a href="#ownership-certificates" class="table-of-contents__link toc-highlight">Ownership Certificates</a><ul><li><a href="#receiver-certificates" class="table-of-contents__link toc-highlight">Receiver Certificates</a></li><li><a href="#sender-certificates" class="table-of-contents__link toc-highlight">Sender Certificates</a></li></ul></li><li><a href="#zero-knowledge-transfer-proof" class="table-of-contents__link toc-highlight">Zero-Knowledge Transfer Proof</a></li><li><a href="#generalized-n-to-m-transfer-protocol" class="table-of-contents__link toc-highlight">Generalized N-to-M Transfer Protocol</a></li><li><a href="#theres-more" class="table-of-contents__link toc-highlight">There&#39;s More</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/Introduction">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/manta/Overview">Manta Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/calamari/Overview">Calamari Overview</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/mantanetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://t.me/mantanetworkofficial" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.gg/MnaM4mqq" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/Manta-Network" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="mailto:contact@manta.network" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Email<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2019-2022 Manta Network. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.54a416bb.js"></script>
<script src="/assets/js/main.2caad291.js"></script>
</body>
</html>