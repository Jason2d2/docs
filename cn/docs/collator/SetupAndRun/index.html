<!doctype html>
<html class="docs-version-current" lang="cn" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">🚄 安装并运行 Calamari 节点 | Manta Network Technical Resources</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.manta.network/cn/docs/collator/SetupAndRun"><meta data-react-helmet="true" name="docusaurus_locale" content="cn"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="🚄 安装并运行 Calamari 节点 | Manta Network Technical Resources"><meta data-react-helmet="true" name="description" content="安装"><meta data-react-helmet="true" property="og:description" content="安装"><link data-react-helmet="true" rel="icon" href="/cn/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.manta.network/cn/docs/collator/SetupAndRun"><link data-react-helmet="true" rel="alternate" href="https://docs.manta.network/docs/collator/SetupAndRun" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.manta.network/cn/docs/collator/SetupAndRun" hreflang="cn"><link data-react-helmet="true" rel="alternate" href="https://docs.manta.network/docs/collator/SetupAndRun" hreflang="x-default"><link rel="stylesheet" href="/cn/assets/css/styles.d71edf38.css">
<link rel="preload" href="/cn/assets/js/runtime~main.cf39acd3.js" as="script">
<link rel="preload" href="/cn/assets/js/main.85428402.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cn/"><div class="navbar__logo"><img src="/cn/img/manta2.png" alt="Manta Network Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/cn/img/manta2.png" alt="Manta Network Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Manta Network 官方文档</b></a><a href="https://manta.network" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Manta Network<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/Manta-Network" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>中文</span></span></a><ul class="dropdown__menu"><li><a href="/docs/collator/SetupAndRun" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/cn/docs/collator/SetupAndRun" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">🌜</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">🌞</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/docs/Introduction">介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/cn/docs/manta/Overview">Manta</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/cn/docs/calamari/Overview">Calamari (Manta 先行网)</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/calamari/Overview">📝 概览</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/calamari/KMA">🐙 Calamari 代币 KMA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/calamari/Governance">🎙  治理概览</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/calamari/api">🛠  Calamari API 接口</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/calamari/CrowdloanClaim">🎟  众贷奖励代币解锁</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/calamari/XcmOnboarding">⛓ XCM Onboarding</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/cn/docs/dolphin/Overview">Dolphin</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/dolphin/Overview">📝 概览</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/dolphin/DolphinPay">🐬 DolphinPay</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/dolphin/PrivatePayment">🤿 隐私支付</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/dolphin/PrivateExchange">💱 隐私交易</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/cn/docs/signer/Overview">Signer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/cn/docs/collator/CommunityCollatorProgram">Collator 节点</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/collator/CommunityCollatorProgram">🧩  社区节点计划</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/collator/HowToApply">👩🏼‍💻 如何申请运行 Calamari 节点？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cn/docs/collator/SetupAndRun">🚄 安装并运行 Calamari 节点</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/collator/HowToLeave">💔 退出节点计划</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/cn/docs/education/ZkpChallenge">Learn About Zero-Knowledge Proofs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/education/ZkpChallenge">Manta Zero Knowledge Proof Challenge</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">本页</button></div><div class="theme-doc-markdown markdown"><h1>🚄 安装并运行 Calamari 节点</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="安装">安装<a class="hash-link" href="#安装" title="直接链接到标题">​</a></h2><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LplD tabs__item--active">docker</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">fedora</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">ubuntu</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">other linux</li></ul><div class="margin-vert--md"><div role="tabpanel">- 拉取最新 Calamari 容器镜像<div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker pull mantanetwork/calamari:latest</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></div><div role="tabpanel" hidden=""><p>manta .rpm 包含：</p><ul><li>manta 二进制文件（用于运行 calamari）</li><li>manta 和 calamari 系统文件</li><li>manta、calamari、polkadot 和 kusama 基础配置文件</li><li>用于安装后运行创建 systemd 服务和 manta 帐户的脚本文件</li></ul><p>开始安装(另见: <a href="https://rpm.manta.systems/" target="_blank" rel="noopener noreferrer">rpm.manta.systems</a>):</p><ul><li><p>添加 manta .rpm 存储库</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash </span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> dnf </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> dnf-plugins-core</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> dnf config-manager --add-repo https://rpm.manta.systems/manta.repo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> dnf config-manager --set-enabled manta</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> dnf update</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>安装 Manta</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> dnf </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> manta</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li></ul></div><div role="tabpanel" hidden=""><p>manta .rpm 包含：</p><ul><li>manta 二进制文件（用于运行 calamari）</li><li>manta 和 calamari 系统文件</li><li>manta、calamari、polkadot 和 kusama 基础配置文件</li><li>用于安装后运行创建 systemd 服务和 manta 帐户的脚本文件</li></ul><p>开始安装 (另见: <a href="https://rpm.manta.systems/" target="_blank" rel="noopener noreferrer">rpm.manta.systems</a>):</p><ul><li><p>添加 manta .deb 存储库</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -o /usr/share/keyrings/manta.gpg https://deb.manta.systems/manta.gpg</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -o /etc/apt/sources.list.d/manta.list https://deb.manta.systems/manta.list</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> update</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>安装 Manta</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> manta</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li></ul></div><div role="tabpanel" hidden=""><ul><li><p>下载二进制、区块链配置和系统单元文件</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># intall jq on ubuntu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> jq</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># or on fedora</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> dnf </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> jq</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># get the latest version of binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">manta_version</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">curl</span><span class="token variable" style="color:rgb(191, 199, 213)"> -s https://api.github.com/repos/Manta-Network/Manta/releases/latest </span><span class="token variable operator" style="color:rgb(137, 221, 255)">|</span><span class="token variable" style="color:rgb(191, 199, 213)"> jq -r .tag_name </span><span class="token variable operator" style="color:rgb(137, 221, 255)">|</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable function" style="color:rgb(130, 170, 255)">cut</span><span class="token variable" style="color:rgb(191, 199, 213)"> -c </span><span class="token variable number" style="color:rgb(247, 140, 108)">2</span><span class="token variable" style="color:rgb(191, 199, 213)">-</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -Lo /usr/local/bin/manta https://github.com/Manta-Network/Manta/releases/download/v</span><span class="token variable" style="color:rgb(191, 199, 213)">${manta_version}</span><span class="token plain">/manta</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">ln</span><span class="token plain"> -srf /usr/local/bin/manta /usr/local/bin/calamari</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># chainspecs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> -p /usr/share/substrate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -Lo /usr/share/substrate/calamari.json https://raw.githubusercontent.com/Manta-Network/Manta/v3.0.9/genesis/calamari-genesis.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -Lo /usr/share/substrate/kusama.json https://raw.githubusercontent.com/paritytech/polkadot/master/node/service/res/kusama.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># systemd unit file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -Lo /etc/systemd/system/calamari.service https://raw.githubusercontent.com/Manta-Network/Manta/deb-rpm/scripts/package/calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>创建 Manta 系统帐户</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">groupadd</span><span class="token plain"> --system manta</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">useradd</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --system </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --gid manta </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --home-dir /var/lib/substrate </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --create-home </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --shell /sbin/nologin </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --comment </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;service account for manta and calamari services&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    manta</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li></ul></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="配置">配置<a class="hash-link" href="#配置" title="直接链接到标题">​</a></h2><p>需要一些额外有助于节点的相关配置命令。</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LplD tabs__item--active">fedora</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">ubuntu</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">other linux</li></ul><div class="margin-vert--md"><div role="tabpanel"><p>编辑 calamari 服务单元文件中 <code>ExecStart</code> 下的参数项。</p><p><code>/usr/lib/systemd/system/calamari.service</code></p><div class="codeBlockContainer_I0IT language-ini theme-code-block"><div class="codeBlockContent_wNvx ini"><pre tabindex="0" class="prism-code language-ini codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ExecStart=/usr/bin/calamari \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --collator \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name &#x27;my parachain collator node name&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --chain /usr/share/substrate/calamari.json \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --base-path /var/lib/substrate \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --port 31333 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ws-port 9144 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ws-max-connections 100 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-port 9133 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-cors all \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-methods auto \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --prometheus-port 9615 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --prometheus-external \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --state-cache-size 0 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --bootnodes \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/crispy.calamari.systems/tcp/30333/p2p/12D3KooWNE4LBfkYB2B7D4r9vL54YMMGsfAsXdkhWfBw8VHJSEQc \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/crunchy.calamari.systems/tcp/30333/p2p/12D3KooWL3ELxcoMGA6han3wPQoym5DKbYHqkWkCuqyjaCXpyJTt \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/hotdog.calamari.systems/tcp/30333/p2p/12D3KooWBdto53HnArmLdtf2RXzNWti7hD5mML7DWGZPD8q4cywv \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/tasty.calamari.systems/tcp/30333/p2p/12D3KooWGs2hfnRQ3Y2eAoUyWKUL3g7Jmcsf8FpyhVYeNpXeBMSu \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/tender.calamari.systems/tcp/30333/p2p/12D3KooWNXZeUSEKRPsp1yiDH99qSVawQSWHqG4umPjgHsn1joci \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name &#x27;my embedded relay node name&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --chain /usr/share/substrate/kusama.json \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --port 31334 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ws-port 9145 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-port 9134 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --prometheus-port 9616 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --prometheus-external \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --telemetry-url &#x27;wss://api.telemetry.manta.systems/submit/ 0&#x27;</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></div><div role="tabpanel" hidden=""><p>编辑 calamari 服务单元文件中 <code>ExecStart</code> 下的参数项。</p><p><code>/usr/lib/systemd/system/calamari.service</code></p><div class="codeBlockContainer_I0IT language-ini theme-code-block"><div class="codeBlockContent_wNvx ini"><pre tabindex="0" class="prism-code language-ini codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ExecStart=/usr/bin/calamari \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --collator \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name &#x27;my parachain collator node name&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --chain /usr/share/substrate/calamari.json \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --base-path /var/lib/substrate \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --port 31333 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ws-port 9144 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ws-max-connections 100 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-port 9133 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-cors all \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-methods auto \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --prometheus-port 9615 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --prometheus-external \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --state-cache-size 0 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --bootnodes \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/crispy.calamari.systems/tcp/30333/p2p/12D3KooWNE4LBfkYB2B7D4r9vL54YMMGsfAsXdkhWfBw8VHJSEQc \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/crunchy.calamari.systems/tcp/30333/p2p/12D3KooWL3ELxcoMGA6han3wPQoym5DKbYHqkWkCuqyjaCXpyJTt \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/hotdog.calamari.systems/tcp/30333/p2p/12D3KooWBdto53HnArmLdtf2RXzNWti7hD5mML7DWGZPD8q4cywv \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/tasty.calamari.systems/tcp/30333/p2p/12D3KooWGs2hfnRQ3Y2eAoUyWKUL3g7Jmcsf8FpyhVYeNpXeBMSu \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/tender.calamari.systems/tcp/30333/p2p/12D3KooWNXZeUSEKRPsp1yiDH99qSVawQSWHqG4umPjgHsn1joci \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name &#x27;my embedded relay node name&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --chain /usr/share/substrate/kusama.json \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --port 31334 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ws-port 9145 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-port 9134 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --prometheus-port 9616 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --prometheus-external \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --telemetry-url &#x27;wss://api.telemetry.manta.systems/submit/ 0&#x27;</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></div><div role="tabpanel" hidden=""><p>编辑 calamari 服务单元文件中 <code>ExecStart</code> 下的参数项。</p><p><code>/etc/systemd/system/calamari.service</code></p><div class="codeBlockContainer_I0IT language-ini theme-code-block"><div class="codeBlockContent_wNvx ini"><pre tabindex="0" class="prism-code language-ini codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ExecStart=/usr/local/bin/calamari \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --collator \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name &#x27;my parachain collator node name&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --chain /usr/share/substrate/calamari.json \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --base-path /var/lib/substrate \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --port 31333 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ws-port 9144 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ws-max-connections 100 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-port 9133 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-cors all \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-methods auto \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --prometheus-port 9615 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --prometheus-external \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --state-cache-size 0 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --bootnodes \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/crispy.calamari.systems/tcp/30333/p2p/12D3KooWNE4LBfkYB2B7D4r9vL54YMMGsfAsXdkhWfBw8VHJSEQc \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/crunchy.calamari.systems/tcp/30333/p2p/12D3KooWL3ELxcoMGA6han3wPQoym5DKbYHqkWkCuqyjaCXpyJTt \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/hotdog.calamari.systems/tcp/30333/p2p/12D3KooWBdto53HnArmLdtf2RXzNWti7hD5mML7DWGZPD8q4cywv \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/tasty.calamari.systems/tcp/30333/p2p/12D3KooWGs2hfnRQ3Y2eAoUyWKUL3g7Jmcsf8FpyhVYeNpXeBMSu \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /dns/tender.calamari.systems/tcp/30333/p2p/12D3KooWNXZeUSEKRPsp1yiDH99qSVawQSWHqG4umPjgHsn1joci \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name &#x27;my embedded relay node name&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --chain /usr/share/substrate/kusama.json \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --port 31334 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ws-port 9145 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-port 9134 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --prometheus-port 9616 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --prometheus-external \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --telemetry-url &#x27;wss://api.telemetry.manta.systems/submit/ 0&#x27;</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="节点配置特殊参数">节点配置特殊参数<a class="hash-link" href="#节点配置特殊参数" title="直接链接到标题">​</a></h3><p>Calamari 节点配置文件支持两组由双破折号 (<code>—</code>) 分隔的参数。 第一组为平行链节点参数。 第二组为中继链节点参数。</p><ul><li><strong><em>平行链</em></strong> 参数<ul><li><code>--collator</code>: 在 collator 模式下运行。与<code>--validator</code>中继链相同。设置此项也会令 pruning 模式为<code>archive</code>（如<code>--pruning archive</code>）</li><li><code>--name</code>: 平行链节点名称，显示在 <a href="https://telemetry.manta.systems/#list/0x4ac80c99289841dd946ef92765bf659a307d39189b3ce374a92b5f0415ee17a1" target="_blank" rel="noopener noreferrer">calamari telemetry</a></li><li><code>--port</code>: 平行链点对点端口。 calamari 默认为 31333，可通过此端口访问其他 calamari 节点。</li><li><code>--prometheus-port</code>: 平行链指标端口。 calamari 默认为 9615。manta 指标监控服务器<code>18.156.192.254</code>（按子网配置为<code>18.156.192.254/32</code>）需可访问此端口。</li><li><code>--prometheus-external</code>: 如果指标端口不通过 ssl 反向代理，您可能需要设置此参数来告诉指标服务器侦听 <em>all ips</em> 套接字 (<code>0.0.0.0:9615</code>) 而不是 <em>localhost only</em> (<code>127.0 .0.1:9615</code>)</li></ul></li><li><strong><em>中继链</em></strong> 参数<ul><li><code>--name</code>: 中继节点名称，显示在 <a href="https://telemetry.manta.systems/#list/0xb0a8d493285c2df73290dfb7e61f870f17b41801197a149ca93654499ea3dafe" target="_blank" rel="noopener noreferrer">kusama telemetry</a></li><li><code>--port</code>: 中继链点对点端口。 calamari-embedded-kusama 默认为 31334。可通过此端口访问其他 kusama 节点。</li><li><code>--prometheus-port</code>: 中继链指标端口。 calamari-embedded-kusama 默认为 9616。manta 指标监控服务器<code>18.156.192.254</code>（按子网配置为<code>18.156.192.254/32</code>）需可访问此端口</li><li><code>--prometheus-external</code>: 如果指标端口不通过 ssl 反向代理，您可能需要设置此参数来告诉指标服务器侦听 <em>all ips</em> 套接字 (<code>0.0.0.0:9616</code>) 而不是 <em>localhost only</em> (<code>127.0 .0.1:9616</code>)</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="开放节点运行指标监控">开放节点运行指标监控<a class="hash-link" href="#开放节点运行指标监控" title="直接链接到标题">​</a></h3><p>使用 <a href="https://wiki.polkadot.network/docs/maintain-guides-how-to-monitor-your-node" target="_blank" rel="noopener noreferrer">polkadot wiki</a> 上描述的技术监控您的 Collator 节点。端口 <code>9615</code> 和 <code>9616</code> 上公开的指标有助于实现这一点，这些端口应可访问 prometheus/alertmanager 服务器（alertmanager 配置提醒服务）和 manta  <code>18.156.192.254</code> 监控服务器<a href="https://pulse.pelagos.systems" target="_blank" rel="noopener noreferrer">pulse server</a>。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="防火墙配置">防火墙配置<a class="hash-link" href="#防火墙配置" title="直接链接到标题">​</a></h3><p>为保证节点正常运行，需要从外部访问主机的以下几个端口。 为了简化配置，文档里使用以下端口为默认端口，但您也可以根据实际需求来更改端口。</p><ul><li><strong><em>31333</em></strong>: 默认calamari p2p端口</li><li><strong><em>31334</em></strong>: 默认（中继）kusama p2p端口</li><li><strong><em>9615</em></strong>: 默认 calamari prometheus端口</li><li><strong><em>9616</em></strong>: 默认（中继）kusama prometheus端口</li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="通过sslletsencrypt-和-nginx反向代理获取主机的metrics">通过ssl，letsencrypt 和 nginx反向代理获取主机的metrics<a class="hash-link" href="#通过sslletsencrypt-和-nginx反向代理获取主机的metrics" title="直接链接到标题">​</a></h4><p>下面是一个最佳实践获取你的节点的metrics：</p><ul><li><strong><em>ssl</em>，</strong> 此方式下，metrics的可靠性和来源都能够被验证。</li><li><strong><em>dns</em>，</strong>即使你的节点的机器的IP地址变动了，也不会需要触发服务器更新。</li></ul><p>当提供的是域名，比如像 <code>calamari.awesome-host.awesome-collators.com</code> ，这样我们的监控系统更加容易地获取节点的运行情况。但如果使用的是IP，比如<code>123.123.123.123:987</code>， 这样可能会不太容易区分是哪一个节点被监听，也可能不知道监听的是中继链或者是平行链。</p><p>一个比较简单的办法就是安装 certbot和 nginx到你的主机上，并配置443端口为反向代理监听端口，这个端口会代理ssl请求到本地的metric端口。</p><p>下面列举一个简单的例子：</p><ul><li>你是域名 <strong><em>example.com</em></strong> 的管理员。</li><li>这个域名被 cloudfare或者route53管理。</li><li>你的节点主机名叫 <strong><em>bob</em>。</strong></li><li>你所跑的calamari节点都使用了默认的端口。</li><li>你的路由网关转发 443/ssl 网络请求到你的collator节点。</li><li>你的主机安装了 certbot。</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>cloudfare和route53的例子如下。但你也可以google <code>python3-certbot-dns-${your_dns_provider}</code>，得到其他的例子。</p></div></div><ul><li><p>安装 certbot 和一个dns验证插件</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LplD tabs__item--active">fedora</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">ubuntu</li></ul><div class="margin-vert--md"><div role="tabpanel">```bash #!/bin/bash sudo dnf install \ certbot \ python3-certbot-dns-cloudflare \ python3-certbot-dns-route53 ```</div><div role="tabpanel" hidden=""><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  certbot </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  python3-certbot-dns-cloudflare </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  python3-certbot-dns-route53</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></div></div></div></li><li><p>通过dns的插件请求一个证书，这样certbot能够自动地更新证书当证书要过期时。但是手动地请求证书，也必须要手动地更新证书来保证ssl证书是有效的。</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LplD tabs__item--active">cloudflare</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">route53</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> certbot certonly </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --dns-cloudflare </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --dns-cloudflare-credentials .cloudflare-credentials </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -d bob.example.com </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -d calamari.metrics.bob.example.com </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -d kusama.metrics.bob.example.com</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> certbot certonly </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --dns-route53 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --dns-route53-propagation-seconds </span><span class="token number" style="color:rgb(247, 140, 108)">30</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -d bob.example.com </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -d calamari.metrics.bob.example.com </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -d kusama.metrics.bob.example.com</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></div></div></div></li><li><p>配置 nginx<code>/etc/nginx/sites-enabled/example.com.conf</code>将代理 dns 子域反向到本地指标端口。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    server_name calamari.metrics.bob.example.com;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    listen 443 ssl;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gzip off;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    location / {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_pass http://127.0.0.1:9615;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_http_version 1.1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header X-Real-IP $remote_addr;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header Host $host;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header Upgrade $http_upgrade;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header Connection &quot;upgrade&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    include /etc/letsencrypt/options-ssl-nginx.conf;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    server_name kusama.metrics.bob.example.com;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    listen 443 ssl;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gzip off;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    location / {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_pass http://127.0.0.1:9616;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_http_version 1.1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header X-Real-IP $remote_addr;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header Host $host;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header Upgrade $http_upgrade;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header Connection &quot;upgrade&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    include /etc/letsencrypt/options-ssl-nginx.conf;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li></ul><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LplD tabs__item--active">fedora</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">default_zone</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">sudo</span><span class="token variable" style="color:rgb(191, 199, 213)"> firewall-cmd --get-default-zone</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># calamari p2p</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> firewall-cmd </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --zone</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">${default_zone}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --add-port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">31333</span><span class="token plain">/tcp </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --permanent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># kusama p2p</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> firewall-cmd </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --zone</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">${default_zone}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --add-port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">31334</span><span class="token plain">/tcp </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --permanent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># calamari metrics</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> firewall-cmd </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --zone</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">${default_zone}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --add-port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">9615</span><span class="token plain">/tcp </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --permanent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># kusama metrics</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> firewall-cmd </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --zone</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">${default_zone}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --add-port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">9616</span><span class="token plain">/tcp </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --permanent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> firewall-cmd --reload</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="运行">运行<a class="hash-link" href="#运行" title="直接链接到标题">​</a></h2><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LplD tabs__item--active">docker</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">fedora</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">ubuntu</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">other linux</li></ul><div class="margin-vert--md"><div role="tabpanel"><ul><li><p>启动 docker 节点</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -it </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -p </span><span class="token number" style="color:rgb(247, 140, 108)">9933</span><span class="token plain">:9933 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -p </span><span class="token number" style="color:rgb(247, 140, 108)">30333</span><span class="token plain">:30333 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -v host_path:/container_path </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name your_container_name </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mantanetwork/calamari:latest </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --base-path /container_path/data </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --keystore-path /container_path/keystore </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name your_collator_name </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-cors all </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --collator </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --rpc-methods</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">unsafe </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --unsafe-rpc-external</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>  相关名称和路径示例：</p><p>  <code>host_path:/container_path</code> =&gt; <code>~/my-calamari-db:/calamari</code></p><p>  <code>your_collator_name</code> =&gt; <code>Community-Collator-1</code></p><p>  确保您可以看到这样的一行日志：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">👤 Role: AUTHORITY</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li></ul></div><div role="tabpanel" hidden=""><ul><li><p>检查 calamari 服务状态：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl status calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>启用 calamari 服务（该服务将在系统启动时自启动）：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> systemctl </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">enable</span><span class="token plain"> calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>启动 calamari</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> systemctl start calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>停止 calamari</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> systemctl stop calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>查看 calamari 日志：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -u calamari.service -f</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>调试 calamari 服务配置（以 manta 用户身份运行 calamari，以快速检查运行时错误）：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> -H -u manta </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"> -c </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;/usr/bin/calamari --chain /usr/share/substrate/calamari.json --base-path /var/lib/substrate --port 31333 --ws-port 9144 --ws-max-connections 100 --rpc-port 9133 --rpc-cors all --rpc-methods safe --state-cache-size 0 --bootnodes /dns/crispy.calamari.systems/tcp/30333/p2p/12D3KooWNE4LBfkYB2B7D4r9vL54YMMGsfAsXdkhWfBw8VHJSEQc /dns/crunchy.calamari.systems/tcp/30333/p2p/12D3KooWL3ELxcoMGA6han3wPQoym5DKbYHqkWkCuqyjaCXpyJTt /dns/hotdog.calamari.systems/tcp/30333/p2p/12D3KooWBdto53HnArmLdtf2RXzNWti7hD5mML7DWGZPD8q4cywv /dns/tasty.calamari.systems/tcp/30333/p2p/12D3KooWGs2hfnRQ3Y2eAoUyWKUL3g7Jmcsf8FpyhVYeNpXeBMSu /dns/tender.calamari.systems/tcp/30333/p2p/12D3KooWNXZeUSEKRPsp1yiDH99qSVawQSWHqG4umPjgHsn1joci -- --chain /usr/share/substrate/kusama.json&#x27;</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li></ul></div><div role="tabpanel" hidden=""><ul><li><p>检查 calamari 服务状态：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl status calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>启用 calamari 服务（该服务将在系统启动时自启动）：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> systemctl </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">enable</span><span class="token plain"> calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>启动 calamari</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> systemctl start calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>停止calamari</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> systemctl stop calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>查看 calamari 日志：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -u calamari.service -f</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>调试 calamari 服务配置（以 manta 用户身份运行 calamari，以快速检查运行时错误）：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> -H -u manta </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"> -c </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;/usr/bin/calamari --chain /usr/share/substrate/calamari.json --base-path /var/lib/substrate --port 31333 --ws-port 9144 --ws-max-connections 100 --rpc-port 9133 --rpc-cors all --rpc-methods safe --state-cache-size 0 --bootnodes /dns/crispy.calamari.systems/tcp/30333/p2p/12D3KooWNE4LBfkYB2B7D4r9vL54YMMGsfAsXdkhWfBw8VHJSEQc /dns/crunchy.calamari.systems/tcp/30333/p2p/12D3KooWL3ELxcoMGA6han3wPQoym5DKbYHqkWkCuqyjaCXpyJTt /dns/hotdog.calamari.systems/tcp/30333/p2p/12D3KooWBdto53HnArmLdtf2RXzNWti7hD5mML7DWGZPD8q4cywv /dns/tasty.calamari.systems/tcp/30333/p2p/12D3KooWGs2hfnRQ3Y2eAoUyWKUL3g7Jmcsf8FpyhVYeNpXeBMSu /dns/tender.calamari.systems/tcp/30333/p2p/12D3KooWNXZeUSEKRPsp1yiDH99qSVawQSWHqG4umPjgHsn1joci -- --chain /usr/share/substrate/kusama.json&#x27;</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li></ul></div><div role="tabpanel" hidden=""><ul><li><p>检查 calamari 服务状态：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl status calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>启用 calamari 服务（该服务将在系统启动时自启动）：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> systemctl </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">enable</span><span class="token plain"> calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>启动 calamari</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> systemctl start calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>停止calamari</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> systemctl stop calamari.service</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>查看 calamari 日志：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -u calamari.service -f</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>调试 calamari 服务配置（以 manta 用户身份运行 calamari，以快速检查运行时错误）：</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> -H -u manta </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"> -c </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;/usr/local/bin/calamari --chain /usr/share/substrate/calamari.json --base-path /var/lib/substrate --port 31333 --ws-port 9144 --ws-max-connections 100 --rpc-port 9133 --rpc-cors all --rpc-methods safe --state-cache-size 0 --bootnodes /dns/crispy.calamari.systems/tcp/30333/p2p/12D3KooWNE4LBfkYB2B7D4r9vL54YMMGsfAsXdkhWfBw8VHJSEQc /dns/crunchy.calamari.systems/tcp/30333/p2p/12D3KooWL3ELxcoMGA6han3wPQoym5DKbYHqkWkCuqyjaCXpyJTt /dns/hotdog.calamari.systems/tcp/30333/p2p/12D3KooWBdto53HnArmLdtf2RXzNWti7hD5mML7DWGZPD8q4cywv /dns/tasty.calamari.systems/tcp/30333/p2p/12D3KooWGs2hfnRQ3Y2eAoUyWKUL3g7Jmcsf8FpyhVYeNpXeBMSu /dns/tender.calamari.systems/tcp/30333/p2p/12D3KooWNXZeUSEKRPsp1yiDH99qSVawQSWHqG4umPjgHsn1joci -- --chain /usr/share/substrate/kusama.json&#x27;</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li></ul></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="节点-session-密钥">节点 session 密钥<a class="hash-link" href="#节点-session-密钥" title="直接链接到标题">​</a></h2><p>节点需要两个帐户/密钥。</p><ul><li><strong><em>节点账户</em></strong>: 持有 400,000 KMA 的节点绑定账户。节点所收取的交易费将被存入该账户。 节点运行时绑定的KMA将被锁定。 此帐户密钥要仔细保管，不要存放在于节点服务器中。</li><li><strong><em>aura session 密钥</em></strong>: 这是Collator节点用于创建区块的一次性帐户。 它绑定到节点帐户。 最好的做法是定期更换会话密钥，每个密钥最多使用一次。 当调用 author_insertKey 或 author_rotateKeys rpc 方法时，substrate 将此帐户的密钥存储在节点的文件系统（<code>/var/lib/substrate/chains/calamari/keystore</code>）上的平行链密钥库中。</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>插入和替换方法均使用不安全的 RPC调用来设置节点会话密钥。如果服务正在运行，则必须停止服务，然后使用<code>--rpc-methods=unsafe</code>参数设置。调用成功后，不要忘记将设置更改回<code>safe</code>，因为允许不安全的 rpc 调用会导致暴露的 rpc 端口的节点很容易地让任何人更改其会话密钥，从而导致交易费用被支付到预期之外的地方。</p></div></div><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LplD tabs__item--active">insert</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LplD">rotate</li></ul><div class="margin-vert--md"><div role="tabpanel"><p>此命令演示使用子密钥插入会话密钥 <a href="https://docs.substrate.io/v3/tools/subkey" target="_blank" rel="noopener noreferrer">subkey</a>。</p><ul><li><p>使用 subkey 生成 aura 密钥</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">subkey generate </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --scheme sr25519 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --network calamari </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --output-type json </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --words </span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> ./aura.json</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>创建 author_insertKey rpc payload</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;jsonrpc&quot;:&quot;2.0&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;id&quot;:1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;method&quot;:&quot;author_insertKey&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;params&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        &quot;aura&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        &quot;&lt;mnemonic phrase&gt;&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">        &quot;&lt;public key&gt;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --arg mnemonic </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable" style="color:rgb(191, 199, 213)">jq -r .secretPhrase ./aura.json</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --arg public </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable" style="color:rgb(191, 199, 213)">jq -r .publicKey ./aura.json</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;. | .params[1] = </span><span class="token string variable" style="color:rgb(191, 199, 213)">$mnemonic</span><span class="token string" style="color:rgb(195, 232, 141)"> | .params[2] = </span><span class="token string variable" style="color:rgb(191, 199, 213)">$public</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> ./payload.json</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>执行 author_insertKey rpc payload</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --header </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Content-Type: application/json;charset=utf-8&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --data @./payload.json </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    http://localhost:9133</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p><em>验证</em> (可选)：检查节点使用的aura 助记符是否与生成的匹配</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> -H -u manta </span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> /var/lib/substrate/chains/calamari/keystore/</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">sudo</span><span class="token variable" style="color:rgb(191, 199, 213)"> -H -u manta </span><span class="token variable function" style="color:rgb(130, 170, 255)">ls</span><span class="token variable" style="color:rgb(191, 199, 213)"> /var/lib/substrate/chains/calamari/keystore/</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p><em>验证</em> (可选)：检查日志是否显示节点正在使用认证的角色运行：（<code>AUTHORITY</code>检查时间戳）</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -u calamari.service -g AUTHORITY</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li><li><p>清除: 从系统中aura.json和payload.json文件</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">rm</span><span class="token plain"> ./aura.json ./payload.json</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></li></ul></div><div role="tabpanel" hidden=""><p>此命令演示会话密钥更换。如果不存在则新建一个。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl -H &#x27;Content-Type: application/json&#x27; --data &#x27;{ &quot;jsonrpc&quot;:&quot;2.0&quot;, &quot;method&quot;:&quot;author_rotateKeys&quot;, &quot;id&quot;:1 }&#x27; http://localhost:9933</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>rpc 调用的输出应如下所示（<code>result</code>属性包含 aura 会话帐户公钥的十六进制表示<em>）</em>：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">```json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;result&quot;:&quot;0x06736e65ab33fd1e4e3e434a1fa2c5425f0e263ddb50e6aeb15951288c562f61&quot;,&quot;id&quot;:1}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="将节点帐户绑定到-aura-session-密钥">将节点帐户绑定到 aura session 密钥<a class="hash-link" href="#将节点帐户绑定到-aura-session-密钥" title="直接链接到标题">​</a></h3><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>如果节点日志不包含<code>[Relaychain] 💤 Idle</code>和<code>[Parachain] 💤 Idle</code>消息，您的节点需要继续同步。不要绑定一个未完全同步的节点帐户到 aura 会话密钥。这样做会导致节点被系统拒绝接入。</p></div></div><p>使用 polkadot.js进行账户绑定。</p><ul><li>在浏览器中 打开<a href="https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fws.calamari.systems%2F#/extrinsics" target="_blank" rel="noopener noreferrer">calamari/developer/extrinsics ：</a><img alt="session.setkeys()" src="/cn/assets/images/session.setkeys-9e100922c91348045ce566804c6ce174.png" width="1130" height="469"><ul><li>在标有“using the selected account”的第一个框中，选择持有 400,000 KMA collator绑定帐户。</li><li>在标有“submit the following extrinsic”的第二个（下拉）框中，选择<code>session</code>.</li><li>在第三个（下拉）框中，选择<code>setKeys(keys, proof)</code></li><li>在标有<code>aura: SpConsensusAuraSr25519AppSr25519Public</code> and <code>proof: Bytes</code>第四和第五框中输入 aura 会话密钥的十六进制公钥。</li><li>单击<code>Submit Transaction</code>按钮并等待确认（绿色勾号）</li></ul></li><li>通过在浏览器中加载 <a href="https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fws.calamari.systems%2F#/chainstate" target="_blank" rel="noopener noreferrer">calamari/developer/chainstate</a> 来验证整理者帐户和 aura 会话密钥是否已<em>绑定</em>：
<img alt="session.nextkeys()" src="/cn/assets/images/session.nextkeys-869e6bb09ba971b56aaaf33800674663.png" width="1217" height="593"><ul><li>在第一个（下拉）框中，标记为“selected state query”，选择<code>session</code>.</li><li>在第二个（下拉）框中，选择<code>nextKeys(AccountId32): Option&lt;CalamariRuntimeOpaqueSessionKeys&gt;</code>。</li><li>在第三个（下拉）框中，选择持有 400,000 KMA Collator绑定帐户。</li><li>保持<code>include option</code>选中复选框选中。</li><li><code>blockhash to query at</code>框设置为默认<code>0x</code>值</li><li>单击第二个下拉框右侧的(+) 图标.</li><li>验证是否出现了一个标记为<code>session.nextKeys(AccountId32): Option&lt;CalamariRuntimeOpaqueSessionKeys&gt;</code> 的json 对象，该对象的<code>aura</code>值为之前设置的 aura 会话十六进制公钥。</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="同步">同步<a class="hash-link" href="#同步" title="直接链接到标题">​</a></h2><p>如果中继链上没发现peers，或者您的节点无法验证新块，请确保您节点的时钟准确与 ntp 时间服务器同步。</p><p>提交申请前，您必须同步 calamari 平行链和 kusama 中继链。完全同步的底层区块链节点将在其日志中显示空闲状态，<code>[Relaychain]</code>并且<code>[Parachain]</code>看起来像这样：</p><div class="codeBlockContainer_I0IT language-shell= theme-code-block"><div class="codeBlockContent_wNvx shell="><pre tabindex="0" class="prism-code language-shell= codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">2022-03-01 17:18:58 [Parachain] 💤 Idle (49 peers), best: #1037783 (0xa0c5…04a8), finalized #1037781 (0xabd5…1c05), ⬇ 16.7kiB/s ⬆ 14.5kiB/s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2022-03-01 17:18:55 [Relaychain] 💤 Idle (49 peers), best: #11619808 (0x24a5…ad58), finalized #11619804 (0xa362…2df4), ⬇ 478.0kiB/s ⬆ 520.5kiB/s</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>如果节点日志不包含<code>[Relaychain] 💤 Idle</code>和<code>[Parachain] 💤 Idle</code>消息，您的节点需要继续同步。不要绑定一个未完全同步的Collator帐户到 aura 会话密钥。这样做会导致节点被系统拒绝接入。</p><p>最佳的同步方式是持续运行您的节点，直到空闲消息出现在您的日志中。这样做可能需要长达 2 周的时间，但它也会为您提供您正在同步的区块链的完美、经过加密验证和完整的历史记录。</p><p>如果您不想等待漫长的同步完成，可以从 manta 的备份节点获取 calamari 和 kusama 区块链的快速同步副本：</p><ul><li>停止 Calamari 服务</li><li>从 basepath 中删除 calamari 和 kusama 数据库（注意不要删除在basepath下的keystores ）</li><li>获取区块链的副本</li><li>确保整个basepath 及其所有权限都归运行您的节点的用户所有（如需则更改权限）</li><li>启动 Calamari 服务</li><li>验证节点是否正确同步</li><li>等待平行链和中继链空闲消息出现在日志中</li></ul><p>快速同步命令(requires <a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html" target="_blank" rel="noopener noreferrer">aws cli</a>):</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># stop calamari service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> systemctl stop calamari.service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># sync calamari blockchain database</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> -H -u manta aws s3 </span><span class="token function" style="color:rgb(130, 170, 255)">sync</span><span class="token plain"> --region eu-central-1 --no-sign-request --delete s3://calamari-kusama/var/lib/substrate/chains/calamari/db/full /var/lib/substrate/chains/calamari/db/full</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># sync kusama blockchain database</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> -H -u manta aws s3 </span><span class="token function" style="color:rgb(130, 170, 255)">sync</span><span class="token plain"> --region eu-central-1 --no-sign-request --delete s3://calamari-kusama/var/lib/substrate/polkadot/chains/ksmcc3/db/full /var/lib/substrate/polkadot/chains/ksmcc3/db/full</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># update database `current` manifests</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> -H -u manta </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"> -c </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;basename </span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable function" style="color:rgb(130, 170, 255)">ls</span><span class="token string variable" style="color:rgb(191, 199, 213)"> /var/lib/substrate/chains/calamari/db/full/MANIFEST-*</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)"> &gt; /var/lib/substrate/chains/calamari/db/full/CURRENT&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> -H -u manta </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"> -c </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;basename </span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable function" style="color:rgb(130, 170, 255)">ls</span><span class="token string variable" style="color:rgb(191, 199, 213)"> /var/lib/substrate/polkadot/chains/ksmcc3/db/full/MANIFEST-*</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)"> &gt; /var/lib/substrate/polkadot/chains/ksmcc3/db/full/CURRENT&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> -H -u manta </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"> -c </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;basename </span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable function" style="color:rgb(130, 170, 255)">ls</span><span class="token string variable" style="color:rgb(191, 199, 213)"> /var/lib/substrate/polkadot/chains/ksmcc3/db/full/parachains/db/MANIFEST-*</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)"> &gt; /var/lib/substrate/polkadot/chains/ksmcc3/db/full/parachains/db/CURRENT&#x27;</span><br></span></code></pre><button type="button" aria-label="将代码复制到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="等待">等待<a class="hash-link" href="#等待" title="直接链接到标题">​</a></h2><p>确保已完成<a href="https://docs.google.com/forms/d/e/1FAIpQLScizDDMq7jWeOPVVEMr3EY_Z6N6ugdkL8aKgAbZ9lAJX6DEOQ/viewform" target="_blank" rel="noopener noreferrer">节点申请</a>填写。如果获得批准，Calamari 理事会将提交一项提议，将您提升为候选人</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>候选人并不意味着您是节点。例如，如果有 3 个候选名额，而其他候选人占据所有名额，而您在第 4 名，则必须等到某个节点注销或理事会增加
节点名额。</p></div></div><p>如果顺利成为节点，在候选议案通过后<code>12</code>到<code>24</code>几小时，您将在浏览器中看到节点开始生成块 <a href="https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fws.calamari.systems%2F#/explorer" target="_blank" rel="noopener noreferrer">explorer</a>.。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Manta-Network/docs/edit/main/docs/collator/SetupAndRun.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑本页面</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档页面导航"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/cn/docs/collator/HowToApply"><div class="pagination-nav__sublabel">上一篇</div><div class="pagination-nav__label">👩🏼‍💻 如何申请运行 Calamari 节点？</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/cn/docs/collator/HowToLeave"><div class="pagination-nav__sublabel">下一篇</div><div class="pagination-nav__label">💔 退出节点计划</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#安装" class="table-of-contents__link toc-highlight">安装</a></li><li><a href="#配置" class="table-of-contents__link toc-highlight">配置</a><ul><li><a href="#节点配置特殊参数" class="table-of-contents__link toc-highlight">节点配置特殊参数</a></li><li><a href="#开放节点运行指标监控" class="table-of-contents__link toc-highlight">开放节点运行指标监控</a></li><li><a href="#防火墙配置" class="table-of-contents__link toc-highlight">防火墙配置</a></li></ul></li><li><a href="#运行" class="table-of-contents__link toc-highlight">运行</a></li><li><a href="#节点-session-密钥" class="table-of-contents__link toc-highlight">节点 session 密钥</a><ul><li><a href="#将节点帐户绑定到-aura-session-密钥" class="table-of-contents__link toc-highlight">将节点帐户绑定到 aura session 密钥</a></li></ul></li><li><a href="#同步" class="table-of-contents__link toc-highlight">同步</a></li><li><a href="#等待" class="table-of-contents__link toc-highlight">等待</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/cn/docs/Introduction">介绍</a></li><li class="footer__item"><a class="footer__link-item" href="/cn/docs/manta/Overview">Manta 概览</a></li><li class="footer__item"><a class="footer__link-item" href="/cn/docs/calamari/Overview">Calamari 概览</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/mantanetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://t.me/mantanetworkofficial" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.gg/MnaM4mqq" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多的</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/Manta-Network" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="mailto:contact@manta.network" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Email<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">版权 © 2019-2022 Manta Network.</div></div></div></footer></div>
<script src="/cn/assets/js/runtime~main.cf39acd3.js"></script>
<script src="/cn/assets/js/main.85428402.js"></script>
</body>
</html>